name=eudev
version=3.2.2
desc="Userspace device management daemon"
deps="kmod gperf coreutils hwids"
source="http://dev.gentoo.org/~blueness/$name/$name-$version.tar.gz
"

build() {
	cd $name-$version
	./configure --prefix= \
	    --sysconfdir=/etc \
	    --sbindir=/bin \
	    --disable-manpages \
	    --disable-static \
	    --enable-split-usr \
	    --enable-kmod \
	    --enable-hwdb \
	    --disable-introspection 
	    #--disable-gudev \
	    #--disable-static \
	make CFLAGS="$CFLAGS -D_GNU_SOURCE"  || die
	make install DESTDIR="$pkgdir"  || die
	make -C man install DESTDIR="$pkgdir"  || die
	install -d "$pkgdir"/lib/firmware
	install -d "$pkgdir"/lib/udev/devices/pts
	install -d "$pkgdir"/lib/udev/devices/shm
	sed -i 's#GROUP="dialout"#GROUP="uucp"#g;
	s#GROUP="tape"#GROUP="storage"#g;
	s#GROUP="cdrom"#GROUP="optical"#g' "$pkgdir"/lib/udev/rules.d/*.rules
	udevadm hwdb -r "$pkgdir" -u
}
