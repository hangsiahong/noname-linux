name=cryptsetup
version=1.7.5
desc="Userspace setup tool for transparent encryption of block devices using dm-crypt"
deps="lvm2 libgcrypt popt util-linux"
source="https://www.kernel.org/pub/linux/utils/cryptsetup/v${version%.*}/${name}-${version}.tar.xz
encrypt_hook
encrypt_install
sd-encrypt
"

build() {
	 cd $name-${version}
	 ./configure --prefix= --sbindir=/bin --disable-static --enable-cryptsetup-reencrypt
	 make || die
	 make DESTDIR="${pkgdir}" install || die
	 install -D -m644 "${srcdir}"/encrypt_hook "${pkgdir}"/lib/initcpio/hooks/encrypt
	 install -D -m644 "${srcdir}"/encrypt_install "${pkgdir}"/lib/initcpio/install/encrypt
	 install -D -m644 "${srcdir}"/sd-encrypt "${pkgdir}"/lib/initcpio/install/sd-encrypt
}
