name=fcitx
version=4.2.9.1
desc="A Flexible Input Method Framework"
deps="gtk3 gtk cairo pango libxrender libxfixes icu python libxkbcommon extra-cmake-modules dbus iso-codes shared-mime-info opencc gobject-introspection"
source="https://download.fcitx-im.org/fcitx/fcitx-$version.tar.xz
musl.patch"

build(){
	cd $name-$version
	patch -p1 < ../musl.patch || die
	sed -i '/Libexecinfo/d' CMakeLists.txt
	mkdir build
	cd build
	cmake .. \
		-DCMAKE_INSTALL_PREFIX= \
		-DSYSCONFDIR=/etc \
		-DENABLE_GTK2_IM_MODULE=ON -DENABLE_GTK3_IM_MODULE=ON -DENABLE_QT_IM_MODULE=OFF \
		-DENABLE_QT=OFF \
		-DENABLE_ENCHANT=OFF \
		-DENABLE_OPENCC=ON -DENABLE_PRESAGE=OFF \
		-DENABLE_GIR=ON

	make || die
	make DESTDIR="$pkgdir" install || die
	rm -r "$pkgdir"/share/doc
}
