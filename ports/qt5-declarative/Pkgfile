name=qt5-declarative
version=5.9.1
desc='Classes for QML and JavaScript languages'
deps="qt5-base qt5-xmlpatterns"
source="http://download.qt.io/official_releases/qt/${version%.*}/$version/submodules/qtdeclarative-opensource-src-$version.tar.xz
qt-musl-stackbottom.patch"

ext() {
	cd qtdeclarative-opensource-src-$version
	patch -p1 < ../qt-musl-stackbottom.patch || die
}

build() {
	mkdir -p build
	cd build

	qmake ../qtdeclarative-opensource-src-$version
	make || die
	make INSTALL_ROOT="$pkgdir" install || die

	find "$pkgdir/lib" -type f -name '*.prl' \
	-exec sed -i -e '/^QMAKE_PRL_BUILD_DIR/d' {} \;
}
