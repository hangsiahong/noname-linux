--- a/ping.c
+++ b/ping.c
@@ -208,8 +208,10 @@
 #ifdef USE_IDN
 	setlocale(LC_ALL, "");
 #endif
+#ifdef __GLIBC__
 	if (!strcmp(setlocale(LC_ALL, NULL), "C"))
 		hints.ai_flags &= ~ AI_CANONIDN;
+#endif 
 
 	/* Support being called using `ping4` or `ping6` symlinks */
 	if (argv[0][strlen(argv[0])-1] == '4')
